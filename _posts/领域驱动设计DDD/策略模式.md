税率业务

- 对于不同国家有不同的税率规则
- 对于不同类型的客户和情况给出不同的税率

技术设计

- 计算税率并存储
- 查询税率

底层数据模型

- 一个税率规则大表
- 三个税率规则子表
  - 特殊优惠税率
  - 达人税率
  - 国家地区税率                                                                                                                                                 
- 计算出的税率表
  - 客户+账户为主键
  - 存储计算出来的税率

计算税率程序设计

- 客户端给出部分信息
- 加上部分反查信息得到计算税率的所有信息
- 根据这些信息和已有税率规则，计算出税率

实际案例

- 印度某些地区税率10%，税种A类型
- 印度某些地区税率2%，税种B类型
- 欧美地区税率12%，税种A类型
- 印度达人情况，税率0%，税种A类型
- 印度尼西亚优惠税率0%，税种C类型

目前代码逻辑

- 对信息进行整理计算

- 根据整理好的信息，以及规则优先级去数据库匹配税率规则
- 返回首次匹配到的税率，没匹配到就返回默认税率

领域建模

- 税率、税种

- 税率规则

- 计算税率的各类信息
  - 国家地区
  - 是否达人
  - 特殊字段等等
  - 总而言之，就是用来计算税率的信息很多，同时不是一次性全部给出，需要根据情况去查的。

- 客户、账户 

